table1 <- count(count_matrix, nc_01)
table1 <- count(count_matrix, 'nc_01')
View(count_matrix)
table = histcounts(count_matrix)
table1 <- count(count_matrix, nc_01)
rownames(table1) <- table1$nc_01
bins = seq()
table1 <- count(count_matrix, nc_01)
bins = seq(from = 1, to = 3299565, length.out = 3300)
bins = seq(from = 1, to = 3299565, length.out = 33000)
histc(count_matrix, bins)
install.packages('pracma')
library('pracma')
histc(count_matrix, bins)
type(count_matrix$nc_01)
count_matrix$nc_01.as.numeric
count_matrix[, c(1:8)] <- sapply(count_matrix[, c(1:8)], as.numeric)
type(count_matrix$nc_01)
typeof(count_matrix$nc_01)
table1 <- count(count_matrix, nc_01)
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table1 <- count(count_matrix, nc_01)
install.packages('plyr')
library('plyr')
table1 <- count(count_matrix, nc_01)
table1 <- count(count_matrix, nc_01)
table1 <- count(count_matrix$nc_01, nc_01)
table1 <- count(count_matrix, nc_01)
table1 <- count(count_matrix, 'nc_01')
View(table1)
rownames(table1) <- table1$nc_01
maximum <- max(table1$nc_01)
table2 <- data.frame(read_number=(1:maximum))
View(table2)
View(table2)
sequence <- table2$read_number
table2$freq <- table1[sequence, 2]
filtered <- filter(table1, nc_01 %in% sequence)
library('dplyr')
table1 <- count(count_matrix, nc_01)
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table1 <- count(count_matrix, nc_01)
View(table1)
table <- count(count_matrix, 'nc_01')
View(table)
View(table)
library('plyr')
library('dplyr')
library('plyr')
table <- count(count_matrix, 'nc_01')
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table <- count(count_matrix, 'nc_01')
View(table)
View(table)
library('plyr')
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table <- count(count_matrix, 'nc_01')
library('plyr')
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table <- count(count_matrix, 'nc_01')
table1 <- count(count_matrix, nc_01)
filtered <- filter(table1, nc_01 %in% sequence)
rownames(table1) <- table1$nc_01
maximum <- max(table1$nc_01)
table2 <- data.frame(read_number=(1:maximum))
sequence <- table2$read_number
filtered <- filter(table1, nc_01 %in% sequence)
table2 <- data.frame(read_number = filtered$nc_01, freq = filtered$n)
View(table2)
table2$freq <- table1[sequence, 2]
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table1 <- count(count_matrix, nc_01)
rownames(table1) <- table1$nc_01
maximum <- max(table1$nc_01)
View(table1)
table2 <- data.frame(read_number=(1:maximum))
View(table2)
sequence <- table2$read_number
table2$freq <- table1[sequence, 2]
table2 <- data.frame(read_number=(0:maximum))
table2 <- data.frame(read_number=(0:maximum))
sequence <- table2$read_number
table2$freq <- table1[sequence, 2]
table2 <- data.frame(read_number=(1:maximum))
sequence <- table2$read_number
rownames(table2) <- table2$read_number
table2$freq <- table1[sequence, 2]
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table1 <- count(count_matrix, nc_01)
rownames(table1) <- table1$nc_01
maximum <- max(table1$nc_01)
table2 <- data.frame(read_number=(1:maximum))
sequence <- table2$read_number
rownames(table2) <- table2$read_number
table2$freq <- table1[sequence, 2]
View(table2)
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
table1 <- count(count_matrix, nc_01)
table1[is.na(table1)] = -1
View(table1)
View(table1)
count_matrix[is.na(count_matrix)] = -1
View(count_matrix)
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
count_matrix_0 <- count_matrix[(count_matrix$nc_01!= 0) &
(count_matrix$nc_02!= 0) &
(count_matrix$kd_01!= 0) &
(count_matrix$kd_02!= 0) &
(count_matrix$nc_01_input!= 0) &
(count_matrix$nc_02_input!= 0) &
(count_matrix$kd_01_input!= 0) &
(count_matrix$kd_02_input!= 0), ]
count_matrix_1 <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
hist(count_matrix_1$nc_01)
hist(count_matrix_1$nc_01)
hist(count_matrix_1$nc_02)
hist(count_matrix_1$kd_01)
hist(count_matrix_1$kd_02)
hist(count_matrix_1$nc_01_input)
hist(count_matrix_1$nc_02_input)
hist(count_matrix_1$kd_01_input)
hist(count_matrix_1$kd_02_input)
NormFactor <- calcNormFactors(object = count_matrix_1, method = "TMM")
LibSize <- colSums(count_matrix_1)
SizeFactors <- NormFactor * LibSize / 1000000
SizeFactors.Reciprocal <- 1/SizeFactors
col.sum <- colSums(count_matrix_1)
check <- as.data.frame(cbind(col.sum, SizeFactors.Reciprocal))
check$ration <- check$SizeFactors.Reciprocal/check$col.sum
library("DESeq2")
library("edgeR")
library(MEDIPS)
library(BSgenome.Hsapiens.UCSC.hg38)
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
count_matrix_0 <- count_matrix[(count_matrix$nc_01!= 0) &
(count_matrix$nc_02!= 0) &
(count_matrix$kd_01!= 0) &
(count_matrix$kd_02!= 0) &
(count_matrix$nc_01_input!= 0) &
(count_matrix$nc_02_input!= 0) &
(count_matrix$kd_01_input!= 0) &
(count_matrix$kd_02_input!= 0), ]
count_matrix_1 <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
NormFactor <- calcNormFactors(object = count_matrix_1, method = "TMM")
LibSize <- colSums(count_matrix_1)
SizeFactors <- NormFactor * LibSize / 1000000
SizeFactors.Reciprocal <- 1/SizeFactors
col.sum <- colSums(count_matrix_1)
check <- as.data.frame(cbind(col.sum, SizeFactors.Reciprocal))
check$ration <- check$SizeFactors.Reciprocal/check$col.sum
View(check)
count_matrix <- read.table("~/count_matrix/mapkapk_h3k4me3", header = TRUE, sep = "\t")
count_matrix_1 <- count_matrix[(count_matrix$nc_01!= 0) &
(count_matrix$nc_02!= 0) &
(count_matrix$kd_01!= 0) &
(count_matrix$kd_02!= 0) &
(count_matrix$nc_01_input!= 0) &
(count_matrix$nc_02_input!= 0) &
(count_matrix$kd_01_input!= 0) &
(count_matrix$kd_02_input!= 0), ]
count_matrix_1 <- count_matrix[(count_matrix$nc_01<227) &
(count_matrix$nc_02<227) &
(count_matrix$kd_01<227) &
(count_matrix$kd_02<227) &
(count_matrix$nc_01_input<227) &
(count_matrix$nc_02_input<227) &
(count_matrix$kd_01_input<227) &
(count_matrix$kd_02_input<227), ]
rm(list = ls())
count_matrix <- read.table("~/count_matrix/mapkapk_h3k4me3", header = TRUE, sep = "\t")
count_matrix_1 <- count_matrix[(count_matrix$nc_01!= 0) &
(count_matrix$nc_02!= 0) &
(count_matrix$kd_01!= 0) &
(count_matrix$kd_02!= 0) &
(count_matrix$nc_01_input!= 0) &
(count_matrix$nc_02_input!= 0) &
(count_matrix$kd_01_input!= 0) &
(count_matrix$kd_02_input!= 0), ]
count_matrix_1 <- count_matrix[(count_matrix$nc_01<227) &
(count_matrix$nc_02<227) &
(count_matrix$kd_01<227) &
(count_matrix$kd_02<227) &
(count_matrix$nc_01_input<227) &
(count_matrix$nc_02_input<227) &
(count_matrix$kd_01_input<227) &
(count_matrix$kd_02_input<227), ]
NormFactor <- calcNormFactors(object = count_matrix_1, method = "TMM")
LibSize <- colSums(count_matrix_1)
SizeFactors <- NormFactor * LibSize / 1000000
SizeFactors.Reciprocal <- 1/SizeFactors
col.sum <- colSums(count_matrix_1)
check <- as.data.frame(cbind(col.sum, SizeFactors.Reciprocal))
check$ration <- check$SizeFactors.Reciprocal/check$col.sum
View(check)
rm(list = ls())
count_matrix <- read.table("~/count_matrix/mapkapk_h3k27me3", header = TRUE, sep = "\t")
count_matrix_1 <- count_matrix[(count_matrix$nc_01!= 0) &
(count_matrix$nc_02!= 0) &
(count_matrix$kd_01!= 0) &
(count_matrix$kd_02!= 0) &
(count_matrix$nc_01_input!= 0) &
(count_matrix$nc_02_input!= 0) &
(count_matrix$kd_01_input!= 0) &
(count_matrix$kd_02_input!= 0), ]
count_matrix_1 <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
NormFactor <- calcNormFactors(object = count_matrix_1, method = "TMM")
LibSize <- colSums(count_matrix_1)
SizeFactors <- NormFactor * LibSize / 1000000
SizeFactors.Reciprocal <- 1/SizeFactors
col.sum <- colSums(count_matrix_1)
check <- as.data.frame(cbind(col.sum, SizeFactors.Reciprocal))
check$ration <- check$SizeFactors.Reciprocal/check$col.sum
View(check)
library("DESeq2")
library("edgeR")
library(MEDIPS)
library(BSgenome.Hsapiens.UCSC.hg38)
library(stringr)
count_matrix <- read.table("~/count_matrix/fgd5", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<162) &
(count_matrix$nc_02<162) &
(count_matrix$kd_01<162) &
(count_matrix$kd_02<162) &
(count_matrix$nc_01_input<162) &
(count_matrix$nc_02_input<162) &
(count_matrix$kd_01_input<162) &
(count_matrix$kd_02_input<162), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/fgd5_162.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- read.table("~/count_matrix/fgd5", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- count_matrix[(count_matrix$nc_01<162) &
(count_matrix$nc_02<162) &
(count_matrix$kd_01<162) &
(count_matrix$kd_02<162) &
(count_matrix$nc_01_input<162) &
(count_matrix$nc_02_input<162) &
(count_matrix$kd_01_input<162) &
(count_matrix$kd_02_input<162), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/fgd5_0_162.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
rm(list = ls())
count_matrix <- read.table("~/count_matrix/emx2os", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<166) &
(count_matrix$nc_02<166) &
(count_matrix$kd_01<166) &
(count_matrix$kd_02<166) &
(count_matrix$nc_01_input<166) &
(count_matrix$nc_02_input<166) &
(count_matrix$kd_01_input<166) &
(count_matrix$kd_02_input<166), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/emx2os_0_166.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/emx2os", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<166) &
(count_matrix$nc_02<166) &
(count_matrix$kd_01<166) &
(count_matrix$kd_02<166) &
(count_matrix$nc_01_input<166) &
(count_matrix$nc_02_input<166) &
(count_matrix$kd_01_input<166) &
(count_matrix$kd_02_input<166), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/emx2os_166.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
rm(list = ls())
count_matrix <- read.table("~/count_matrix/ac", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<127) &
(count_matrix$nc_02<127) &
(count_matrix$kd_01<127) &
(count_matrix$kd_02<127) &
(count_matrix$nc_01_input<127) &
(count_matrix$nc_02_input<127) &
(count_matrix$kd_01_input<127) &
(count_matrix$kd_02_input<127), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/ac_0_127.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/ac", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<127) &
(count_matrix$nc_02<127) &
(count_matrix$kd_01<127) &
(count_matrix$kd_02<127) &
(count_matrix$nc_01_input<127) &
(count_matrix$nc_02_input<127) &
(count_matrix$kd_01_input<127) &
(count_matrix$kd_02_input<127), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/ac_127.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
rm(list = ls())
count_matrix <- read.table("~/count_matrix/rp11", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<67) &
(count_matrix$nc_02<67) &
(count_matrix$kd_01<67) &
(count_matrix$kd_02<67) &
(count_matrix$nc_01_input<67) &
(count_matrix$nc_02_input<67) &
(count_matrix$kd_01_input<67) &
(count_matrix$kd_02_input<67), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/rp11_0_67.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/rp11", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<67) &
(count_matrix$nc_02<67) &
(count_matrix$kd_01<67) &
(count_matrix$kd_02<67) &
(count_matrix$nc_01_input<67) &
(count_matrix$nc_02_input<67) &
(count_matrix$kd_01_input<67) &
(count_matrix$kd_02_input<67), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/rp11_67.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
rm(list = ls())
count_matrix <- read.table("~/count_matrix/ctd", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<46) &
(count_matrix$nc_02<46) &
(count_matrix$kd_01<46) &
(count_matrix$kd_02<46) &
(count_matrix$nc_01_input<46) &
(count_matrix$nc_02_input<46) &
(count_matrix$kd_01_input<46) &
(count_matrix$kd_02_input<46), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/ctd_0_46.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/ctd", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<46) &
(count_matrix$nc_02<46) &
(count_matrix$kd_01<46) &
(count_matrix$kd_02<46) &
(count_matrix$nc_01_input<46) &
(count_matrix$nc_02_input<46) &
(count_matrix$kd_01_input<46) &
(count_matrix$kd_02_input<46), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/ctd_46.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
rm(list = ls())
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/jpx_0_53.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/jpx", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/jpx_53.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/mapkapk_h3k4me3", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/mapkapk5_h3k4_0_200.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
write.table(count_matrix, '~/filter_bam/mapkapk5_h3k4_0_53.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/mapkapk_h3k4me3", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<53) &
(count_matrix$nc_02<53) &
(count_matrix$kd_01<53) &
(count_matrix$kd_02<53) &
(count_matrix$nc_01_input<53) &
(count_matrix$nc_02_input<53) &
(count_matrix$kd_01_input<53) &
(count_matrix$kd_02_input<53), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/mapkapk5_h3k4_53.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
rm(list = ls())
count_matrix <- read.table("~/count_matrix/mapkapk_h3k27me3", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01!=0) &
(count_matrix$nc_02!=0) &
(count_matrix$kd_01!=0) &
(count_matrix$kd_02!=0) &
(count_matrix$nc_01_input!=0) &
(count_matrix$nc_02_input!=0) &
(count_matrix$kd_01_input!=0) &
(count_matrix$kd_02_input!=0), ]
count_matrix <- count_matrix[(count_matrix$nc_01<227) &
(count_matrix$nc_02<227) &
(count_matrix$kd_01<227) &
(count_matrix$kd_02<227) &
(count_matrix$nc_01_input<227) &
(count_matrix$nc_02_input<227) &
(count_matrix$kd_01_input<227) &
(count_matrix$kd_02_input<227), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/mapkapk5_h3k27_0_227.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
count_matrix <- read.table("~/count_matrix/mapkapk_h3k27me3", header = TRUE, sep = "\t")
count_matrix <- count_matrix[(count_matrix$nc_01<227) &
(count_matrix$nc_02<227) &
(count_matrix$kd_01<227) &
(count_matrix$kd_02<227) &
(count_matrix$nc_01_input<227) &
(count_matrix$nc_02_input<227) &
(count_matrix$kd_01_input<227) &
(count_matrix$kd_02_input<227), ]
count_matrix$bed <- row.names(count_matrix)
count_matrix <- str_split_fixed(count_matrix$bed, "_", 3)
write.table(count_matrix, '~/filter_bam/mapkapk5_h3k27_227.bed', quote = FALSE, col.names = FALSE, row.names = FALSE, sep = '\t')
